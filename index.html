<script src="https://apis.google.com/js/api.js"></script>
<button onclick="getProfile()">profile</button>
<button onclick="getInbox()">inbox</button>
<button onclick="getSpam()">spam</button>
<button onclick="getTrash()">trash</button>
<div id="actions"></div>
<ul id="results"></ul>
<script>
var email="me";function authenticate(){return gapi.auth2.getAuthInstance().signIn({scope:"https://mail.google.com/"}).then(function(){console.log("Sign-in successful")},function(e){console.error("Error signing in",e)})}function loadClient(){return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/gmail/v1/rest").then(function(){console.log("GAPI client loaded for API")},function(e){console.error("Error loading GAPI client for API",e)})}function getProfile(){gapi.client.gmail.users.getProfile({userId:email}).then(function(e){displayData(e,"")},function(e){console.error("Execute error",e)})}function getInbox(){gapi.client.gmail.users.messages.list({userId:email}).then(function(e){document.getElementById("actions").innerHTML='<button onclick="allSpam()">all Spam</button><button onclick="allTrash()">all Trash</button>',displayData(e,"spam")},function(e){console.error("Execute error",e)})}function getSpam(){gapi.client.gmail.users.messages.list({userId:email,labelIds:["SPAM"]}).then(function(e){document.getElementById("actions").innerHTML='<button onclick="allInbox()">all Inbox</button><button onclick="deleteAll()">delete all</button>',displayData(e,"notspam")},function(e){console.error("Execute error",e)})}function getTrash(){gapi.client.gmail.users.messages.list({userId:email,labelIds:["TRASH"]}).then(function(e){document.getElementById("actions").innerHTML='<button onclick="allUntrash()">all Untrash</button><button onclick="deleteAll()">delete all</button>',displayData(e,"untrash")},function(e){console.error("Execute error",e)})}function displayData(e,t){e.result.messages?document.getElementById("results").innerHTML=e.result.messages.map(e=>{let n=`<li>${e.id}<button data="action" onclick="${t}('${e.id}')">${t}</button>`;return n+="spam"===t?`<button data="action-trash" onclick="trash('${e.id}')">trash</button>`:"",(n+="untrash"===t||"notspam"===t?`<button data="action-trash" onclick="Delete('${e.id}')">delete</button>`:"")+"</li>"}).join(""):document.getElementById("results").innerHTML=e.body}function spam(e){gapi.client.gmail.users.messages.modify({userId:email,id:e,resource:{addLabelIds:["SPAM"]}}).then(function(e){getInbox()},function(e){console.error("Execute error",e)})}function notspam(e){gapi.client.gmail.users.messages.modify({userId:email,id:e,resource:{removeLabelIds:["SPAM"]}}).then(function(e){getSpam()},function(e){console.error("Execute error",e)})}function allSpam(){let e=setInterval(()=>{document.querySelector('button[data="action"]')?CLICK(document.querySelector('button[data="action"]')):(console.log("job done"),clearInterval(e))},between(3e3,5e3))}function allInbox(){let e=setInterval(()=>{document.querySelector('button[data="action"]')?CLICK(document.querySelector('button[data="action"]')):(console.log("job done"),clearInterval(e))},between(3e3,5e3))}function trash(e){gapi.client.gmail.users.messages.trash({userId:email,id:e}).then(function(e){getInbox()},function(e){console.error("Execute error",e)})}function untrash(e){gapi.client.gmail.users.messages.untrash({userId:email,id:e}).then(function(e){getTrash()},function(e){console.error("Execute error",e)})}function allTrash(){let e=setInterval(()=>{document.querySelector('button[data="action-trash"]')?CLICK(document.querySelector('button[data="action-trash"]')):(console.log("job done"),clearInterval(e))},between(2e3,4e3))}function Delete(e){gapi.client.gmail.users.messages.delete({userId:"me",id:e}).then(function(e){getTrash()},function(e){console.error("Execute error",e)})}function deleteAll(){let e=setInterval(()=>{document.querySelector('button[data="action-trash"]')?CLICK(document.querySelector('button[data="action-trash"]')):(console.log("job done"),clearInterval(e))},between(2e3,3e3))}function CLICK(e){e.dispatchEvent(new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0})),setTimeout(()=>{e.dispatchEvent(new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0}))},500),e.click()}function between(e,t){return Math.floor(Math.random()*(t-e)+e)}gapi.load("client:auth2",function(){gapi.auth2.init({client_id:"313790710921-a8mfrdkr3nac69ojvopft0fhvunnbt7n.apps.googleusercontent.com"}).then(authenticate).then(loadClient).then(getProfile)});
</script>
